          const crops = JSON.parse(jsonStr) as Omit<MarketItem, 'history'>[];
          
          return crops.map((crop) => ({
            ...crop,
            current: Math.round(crop.avg + (Math.random() * 100 - 50)),
            history: generateHistory(crop.avg)
          }));
        }
      }
      // If AI fails but doesn't throw, return fallback
      return fallbackCrops;
    } catch (error) {
      console.error("Error fetching market prices:", error);
      return fallbackCrops;
    }
  },
});
