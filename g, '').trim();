          try {
            const crops = JSON.parse(jsonStr) as MarketItem[];
            return crops.map((crop: MarketItem) => ({
                ...crop,
                current: Math.round(crop.avg + (Math.random() * 100 - 50))
            }));
          } catch (parseError) {
            console.error("JSON Parse Error:", parseError);
            console.log("Raw content that failed to parse:", jsonStr);
          }
        }
      } else {
        console.error("Vly AI request failed or returned no data:", result);
      }
    } catch (error) {
      console.error("Error fetching market prices:", error);
    }
    
    console.log("Returning fallback market data due to error or empty response");
    return fallbackCrops;
  },
});
